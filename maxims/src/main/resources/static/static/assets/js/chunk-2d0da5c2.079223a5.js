(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0da5c2"],{"6aef":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content is-vertical",attrs:{id:"roleManagement"}},[a("div",{staticClass:"content-main"},[a("div",{staticClass:"toolbar"},[a("ri-button",{attrs:{right:"新增",type:"primary",icon:"el-icon-fa fa-plus"},on:{click:e.handleAdd}},[e._v("新建角色")]),a("ri-button",{attrs:{right:"删除",type:"danger",icon:"el-icon-delete",disabled:e.sels.length<1},on:{click:e.batchDelete}},[e._v("批量删除")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"selection-change":e.selsChange}},[a("el-table-column",{attrs:{type:"selection",fixed:"",width:"45px",align:"center"}}),a("el-table-column",{attrs:{type:"index",label:"序号",width:"45px",align:"center"}}),a("el-table-column",{attrs:{property:"name",label:"角色名称",fit:"","min-width":"100px"}}),a("el-table-column",{attrs:{property:"disabled",label:"状态",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.disabled?"danger":"success","disable-transitions":""}},[t.row.disabled?a("label",[e._v("停用")]):a("label",[e._v("启用")])])]}}])}),a("el-table-column",{attrs:{property:"created",label:"创建时间",width:"150px",align:"center"}}),a("el-table-column",{attrs:{property:"memo",label:"架构",formatter:e.structureFormatter,"min-width":"150px"}}),a("el-table-column",{attrs:{property:"memo",label:"描述",fit:"","min-width":"150px"}}),a("el-table-column",{attrs:{property:"",label:"操作",fixed:"right",width:"230px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("ri-button",{staticClass:"table-btn",attrs:{right:"编辑",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),a("ri-button",{staticClass:"table-btn",attrs:{right:"删除",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDel(t.row)}}},[e._v("删除")]),a("el-button",{staticClass:"table-btn",attrs:{type:"text",icon:"el-icon-document"},on:{click:function(a){return e.handleTenantDetail(t.row)}}},[e._v("详细")])]}}])})],1),a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,50,100],"page-size":e.searchForm.page.size,total:e.searchForm.page.total},on:{"current-change":e.pageChange,"size-change":e.handleSizeChange}})],1),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogTableVisible,width:"750px",top:"3vh"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[e.dialogTableVisible?a("div",[a("div",{staticStyle:{display:"flex","margin-bottom":"10px"}},[a("el-form",{ref:"add-editform",staticStyle:{width:"550px"},attrs:{"label-width":"100px",model:e.addEditform,rules:e.rules}},[a("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"角色名称",maxlength:"50"},model:{value:e.addEditform.name,callback:function(t){e.$set(e.addEditform,"name",t)},expression:"addEditform.name"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"disabled"}},[[a("el-radio",{attrs:{label:!1},model:{value:e.addEditform.disabled,callback:function(t){e.$set(e.addEditform,"disabled",t)},expression:"addEditform.disabled"}},[e._v("启用")]),a("el-radio",{attrs:{label:!0},model:{value:e.addEditform.disabled,callback:function(t){e.$set(e.addEditform,"disabled",t)},expression:"addEditform.disabled"}},[e._v("停用")])]],2),a("el-form-item",{attrs:{label:"组织架构",prop:"structure"}},[a("el-cascader",{ref:"cascader",staticStyle:{width:"90%"},attrs:{options:e.structures,"show-all-levels":!1,props:{expandTrigger:"hover",emitPath:!1,checkStrictly:!0,label:"name",value:"id"}},on:{change:e.handleCascaderChangge},model:{value:e.addEditform.structureId,callback:function(t){e.$set(e.addEditform,"structureId",t)},expression:"addEditform.structureId"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"mobile"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{type:"textarea",rows:2,placeholder:"描述"},model:{value:e.addEditform.memo,callback:function(t){e.$set(e.addEditform,"memo",t)},expression:"addEditform.memo"}})],1)],1),a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticStyle:{"overflow-y":"scroll",height:"400px",width:"250px"},attrs:{label:"功能权限",name:"first"}},[a("el-tree",{ref:"elTree",attrs:{props:e.props,data:e.rightTree,"show-checkbox":"","node-key":"id","check-strictly":!0,"default-checked-keys":e.addEditform.rightIdList,"default-expand-all":""}})],1),e._e(),e._e()],1)],1)]):e._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"角色详细信息",visible:e.dialogDetailVisible,width:"650px",top:"3vh"},on:{"update:visible":function(t){e.dialogDetailVisible=t}}},[e.dialogDetailVisible?a("div",[a("div",{staticStyle:{display:"flex","margin-bottom":"10px"}},[a("el-form",{ref:"add-editform",staticStyle:{width:"400px"},attrs:{"label-width":"120px",model:e.addEditform,rules:e.rules}},[a("el-form-item",{attrs:{label:"角色名称"}},[a("label",[e._v(e._s(e.addEditform.name))])]),a("el-form-item",{attrs:{label:"创建时间"}},[a("label",[e._v(e._s(e.addEditform.created))])]),a("el-form-item",{attrs:{label:"修改时间"}},[a("label",[e._v(e._s(e.addEditform.updated))])]),a("el-form-item",{attrs:{label:"状态"}},[[a("el-tag",{attrs:{type:e.addEditform.disabled?"danger":"success","disable-transitions":""}},[e.addEditform.disabled?a("label",[e._v("停用")]):a("label",[e._v("启用")])])]],2),a("el-form-item",{attrs:{label:"组织架构",prop:"structure"}},[a("label",[e._v(e._s(e.structuresMap[e.addEditform.structureId]))])]),a("el-form-item",{attrs:{label:"描  述",prop:"mobile"}},[a("label",[e._v(e._s(e.addEditform.memo))])])],1),a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticStyle:{"overflow-y":"scroll",height:"400px",width:"250px"},attrs:{label:"功能权限",name:"first"}},[a("el-tree",{attrs:{props:e.props,data:e.rightTree,"show-checkbox":"","node-key":"id","default-checked-keys":e.addEditform.rightIdList,"default-expanded-keys":e.addEditform.rightIdList}})],1),e._e(),e._e()],1)],1)]):e._e(),a("div",{staticClass:"dialog-footer",staticStyle:{"margin-top":"30px","margin-right":"40px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogDetailVisible=!1}}},[e._v("返 回")])],1)])],1)},l=[],r=(a("7f7f"),a("ac6a"),{components:{},data:function(){return{title:"帐号管理",activeName:"first",dialogAction:"",dialogTitle:"",dialogTableVisible:!1,dialogDetailVisible:!1,structures:[],structuresMap:{},tableData:[],rightTree:[],sels:[],props:{id:"id",label:"name",children:"children"},searchForm:{page:{number:1,size:10,total:0}},addEditform:{id:"",name:"",memo:"",rightIdList:[],structureId:[],disabled:!1},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:30,message:"长度在 2 到 25 个字符",trigger:"blur"}],authorities:[{required:!0,message:"请输入角色权限",trigger:"blur"}]},userId:""}},created:function(){this.getStructureTree(),this.pageChange(1)},watch:{},methods:{handleClick:function(e,t){console.log(e,t)},handleAdd:function(){this.addEditform={id:"",authorities:"",name:"",memo:"",rightIdList:[],structureId:"",disabled:!1},this.dialogAction="add",this.dialogTitle="新建角色",this.getStructureTree(),this.getRightTree(!0),this.dialogTableVisible=!0},pageChange:function(e){var t=this;e&&(this.searchForm.page.number=e),this.$api.role.findRolePage(this.searchForm).then((function(e){t.tableData=e.data,t.searchForm.page.total=e.page.total}))},handleSizeChange:function(e){var t=this;this.searchForm.page.size=e,this.$api.role.findRolePage(this.searchForm).then((function(e){t.tableData=e.data,t.searchForm.page.total=e.page.total}))},handleSave:function(){var e=this;this.$refs["add-editform"].validate((function(t){return!!t&&(e.addEditform.structureId.length?(e.addEditform.rightIdList=e.$refs.elTree.getCheckedKeys(),void("edit"==e.dialogAction?e.$api.role.updateRole(e.addEditform).then((function(t){200==t.status&&(e.dialogTableVisible=!1,e.pageChange(1),e.$message({message:"编辑角色成功！",type:"success"}))})):"add"==e.dialogAction&&e.$api.role.addRole(e.addEditform).then((function(t){200==t.status&&(e.dialogTableVisible=!1,e.pageChange(1),e.$message({message:"添加角色成功！",type:"success"}))})))):(e.$message({message:"请选择组织架构！",type:"warning"}),!1))}))},handleEdit:function(e){var t=this;this.dialogAction="edit",this.dialogTitle="编辑角色",this.getStructureTree(),this.getRightTree(!0),this.$api.role.findRoleDerail(e.id).then((function(e){t.addEditform=e.data,t.dialogTableVisible=!0}))},handleDel:function(e){var t=this;this.$api.role.deleteRole(e.id).then((function(e){200==e.status&&(t.$message({message:e.message,type:""}),t.pageChange())}))},handleTenantDetail:function(e){var t=this;this.getStructureTree(),this.getRightTree(!1),this.$api.role.findRoleDerail(e.id).then((function(e){t.addEditform=e.data,t.dialogDetailVisible=!0}))},getRightTree:function(e){var t=this;this.$api.role.findRightTree().then((function(a){if(e){var i=function e(a){a.forEach((function(t){t.children&&(t.children.length?e(t.children):t.children=void 0)})),t.rightTree=a};i(a.data)}else{var l=function e(a){a.forEach((function(t){t.children&&(t.disabled=!0,t.children.length?e(t.children):t.children=void 0)})),t.rightTree=a};l(a.data)}}))},getStructureTree:function(){var e=this;this.$api.role.findStructureTree().then((function(t){var a=function t(a){a.forEach((function(a){e.structuresMap[a.id]=a.name,a.children&&(a.children.length?t(a.children):a.children=void 0)})),e.structures=a};a(t.data)}))},selsChange:function(e){return this.sels=e,!0},handleCascaderChangge:function(e){e&&(this.$refs.cascader.dropDownVisible=!1)},batchDelete:function(){var e=this;console.log("点击了批量删除！",this.sels);for(var t=[],a=0;a<this.sels.length;a++)t[a]=this.sels[a].id;this.$api.role.deleteRoleByIds(t).then((function(){e.$message({message:"批量删除角色成功！",type:"success"}),e.pageChange(1)}))},structureFormatter:function(e){var t=this.structuresMap[e.structureId];return t}}}),s=r,d=a("2877"),o=Object(d["a"])(s,i,l,!1,null,"5f07d5e2",null);t["default"]=o.exports}}]);